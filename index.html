<!--
  Essential Assignment Tracker - Home Page
  This web page lets you view, add, edit, and delete assignments.
  It uses HTML for structure, CSS for styling, and JavaScript for logic and interactivity.
-->
<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Character encoding for proper text display -->
    <meta charset="UTF-8" />
    
    <!-- Makes the page responsive when open on mobile devices -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Essential Assignment Tracker - Home</title>

    <!--
      CSS Styles
      These styles control the appearance of the page, including layout, colors, and dark mode.
      There are two main sections: dark mode overrides and default (light mode) styles.
    -->
    <style>
        /*
         * Dark mode overrides: these styles apply when the 'dark-mode' class is on the root element.
         * The root element means the <html> tag at the very top of the page.
         * When <html> has class="dark-mode", all these styles are activated to switch the site to dark mode.
         */

        .dark-mode textarea.notes { color: #fff !important; }
        textarea.notes { color: #111 !important; }

        /* Custom calendar icon for date input in dark mode only */

        .dark-mode input[type="date"]::-webkit-calendar-picker-indicator {
            background: url('data:image/svg+xml;utf8,<svg fill="%23e0e0e0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><rect x="3" y="4" width="18" height="18" rx="2" fill="%23161b22" stroke="%23b411cf" stroke-width="2"/><rect x="7" y="8" width="10" height="8" rx="1" fill="%232d1846"/><path d="M3 8h18" stroke="%23b411cf" stroke-width="2"/></svg>') no-repeat center;
            color: transparent;
            opacity: 1;
        }
        .dark-mode input[type="date"] {
            background: #23263a !important;
            color: #e0e0e0 !important;
            border-color: #444 !important;
        }
        .dark-mode input[type="text"],
        .dark-mode select {
            background: #23263a !important;
            color: #e0e0e0 !important;
            border-color: #444 !important;
        }
        .dark-mode .add-btn {
            background: #28a745 !important;
            color: #fff !important;
            border: 1px solid #218838 !important;
        }
        .dark-mode #deleteAssignmentBtn {
            background: #dc3545 !important;
            color: #fff !important;
            border: 1px solid #a71d2a !important;
        }
        .dark-mode #deleteAssignmentBtn:hover {
            background: #b411cf !important;
            color: #fff !important;
            border-color: #b411cf !important;
        }
                #deleteAssignmentBtn:hover {
                    background: #351d8a !important;
                    color: #fff !important;
                    border-color: #351d8a !important;
                }
        .dark-mode .add-btn:hover {
            background: #218838 !important;
            color: #fff !important;
        }
        .dark-mode .action-btn {
            background: #23263a !important;
            color: #e0e0e0 !important;
            border: 1px solid #444 !important;
        }
        .dark-mode .action-btn:hover {
            background: #2d1846 !important;
            color: #fff !important;
        }
        .dark-mode .action-dropdown {
            background: #23263a !important;
            color: #e0e0e0 !important;
            border-color: #444 !important;
        }
        .dark-mode table {
            background: #161b22 !important;
            color: #e0e0e0 !important;
        }
        .dark-mode th, .dark-mode td {
            background: #23263a !important;
            color: #e0e0e0 !important;
            border-bottom: 1px solid #333 !important;
        }
        .dark-mode th {
            color: #0385b8 !important;
        }
        .dark-mode td {
            color: #e0e0e0 !important;
        }
        .dark-mode body {
            background: #0d1117;
            color: #e0e0e0;
        }
        .dark-mode .header {
            background: linear-gradient(90deg, #0d1117 0%, #2d1846 50%, #0d1117 100%);
            color: #fff;
        }
        .dark-mode .card {
            background: #161b22 !important;
            color: #e0e0e0 !important;
        }
        .dark-mode .nav a {
            color: #fff;
        }
        .dark-mode .nav a:hover {
            color: #58a6ff;
        }
        /* General styling for the entire page */
        body {
            font-family: Arial, sans-serif;
            background: #f8f9fa;
            margin: 0;
            padding: 0;
            color: #333;
        }
        /* Header bar at the top of the page */
        .header {
            background: #270f2b;
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        /* Title styling inside the header */
        .header h1 {
            margin: 0;
            font-size: 1.5rem;
        }
        /* Navigation links in the header */
        .nav a {
            color: white;
            margin-left: 20px;
            text-decoration: none;
            font-weight: bold;
        }
        /* Color change when hovering over nav links */

        .nav a:hover { color: #a5d8ff; }

        /* Main content area - max width centered */
        .content {
            max-width: 1000px;
            margin: 25px auto;
            padding: 0 20px;
        }
        /* Grid layout for counter cards */
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }
        /* Individual counter card styling */
        .card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            /* Shadow for counter cards */
            box-shadow: 0 6px 24px rgba(0,0,0,0.18), 0 1.5px 0 #38b6ff;
            text-align: center;
            position: relative;
            transition: box-shadow 0.3s, transform 0.3s;
        }
        .card:hover {
            /* Animated lift and glow on hover */
            box-shadow: 0 12px 32px rgba(56,182,255,0.22), 0 3px 0 #38b6ff;
            transform: translateY(-8px) scale(1.03);
        }
        .stat-circle {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            margin: 0 auto 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            z-index: 1;
        }
        .stat-circle svg {
            position: absolute;
            top: 0; left: 0;
        }
        .stat-circle .number {
            position: relative;
            z-index: 2;
            font-size: 2.2rem;
            font-weight: bold;
        }
        .stat-anim {
            stroke-dasharray: 220;
            stroke-dashoffset: 220;
            animation: stat-spin 3s ease-in-out infinite;
        }
        @keyframes stat-spin {
            to { stroke-dashoffset: 0; }
        }
        /* Card heading and number styling */

        .card h3 { margin: 0 0 8px; font-size: 1.1rem; color: #434141; }
        .card .number { font-size: 3.2rem; font-weight: bold; }

        /* Color coding for different Assignment statuses */
        .overdue   { color: #dc3545; }    /* Red for overdue */
        .due-soon  { color: #fd7e14; }    /* Orange for due soon */
        .completed { color: #28a745; }    /* Green for completed */
        .active    { color: #0385b8; }    /* light blue */

        /* Main section heading */

        h2 { color: #b411cf; margin: 0 0 15px; }
        .dark-mode h2 { color: #0385b8 !important; }

        /* Search and filter controls layout */

        .controls {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        /* Search input and dropdown styling */

        input[type="text"], select {
            padding: 10px;
            font-size: 1rem;
            border: 1px solid #0770da;
            border-radius: 6px;
            flex: 1;
            min-width: 160px;
        }
        /* Assignment table styling */

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        /* Table header and cell spacing */
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        /* Highlight selected assignment row */

        .assignment-row.selected {
            background: #e0e7ff !important;
            border-left: 5px solid #b411cf;
            transition: background 0.2s, border 0.2s;
        }
        .dark-mode .assignment-row.selected {
            background: #183153 !important;
            border-left: 5px solid #38b6ff;
        }
        /* Table header styling */

        th { background: #e9ecef; color: #5d7b97; }

        /* Status badge styling - shows Assignment status */
        .status {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            display: inline-block;
            min-width: 90px;
            text-align: center;
        }
        /* Status badge colors */
        .status-due     { background: #e4b51f; color: #47074e; }    /* Yellow */
        .status-overdue { background: #f8d7da; color: #fc0d25; }    /* Light red */
        .status-done    { background: #d4edda; color: #155724; }    /* Light green */
        .status-active { background: #0385b8; color: #fff; }    /* light blue badge */
        .action-btn.active { background: #0385b8; color: #fff; } /* blue for button only */
        .status-Completed{ background: #28a745; color: #fdfdfd; }   /* Bright Green */
        /* Green button to add new assignments */
        .add-btn {
            display: inline-block;
            background: #28a745;
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            text-decoration: none;
            font-weight: bold;
            margin-top: 25px;
        }
        /* Button color change on hover */

        .add-btn:hover { background: #218838; }

        /* Modern action buttons */
        .action-btn {
            border: none;
            border-radius: 12px;
            padding: 2px 6px;
            margin: 1px 2px;
            font-size: 0.72rem;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s, color 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 2px;
        }
        .action-btn.active {
            background: #0385b8;
            color: #fff;
        }
        .action-btn.active:hover {
            background: #036fa0;
        }
        .action-btn.due-soon {
            background: #fd7e14;
            color: #fff;
        }
        .action-btn.due-soon:hover {
            background: #ffb347;
        }
        .action-btn.complete {
            background: #28a745;
            color: #fff;
        }
        .action-btn.complete:hover {
            background: #218838;
        }
        .action-btn.overdue {
            background: #dc3545;
            color: #fff;
        }
        .action-btn.overdue:hover {
            background: #a71d2a;
        }
        .action-btn.complete {
            background: #28a745;
            color: #fff;
        }
        .action-btn.complete:hover {
            background: #218838;
        }
        .action-btn.overdue {
            background: #fd7e14;
            color: #fff;
        }
        .action-btn.overdue:hover {
            background: #dc3545;
        }
        /* Dropdown menu for status selection */
        .action-dropdown {
            padding: 2px 4px;
            border-radius: 8px;
            border: 1px solid #0385b8;
            font-size: 0.78rem;
            font-weight: 600;
            color: #0385b8;
            background: #e2e3e5;
            outline: none;
            min-width: 90px;
            max-width: 120px;
            white-space: normal;
            word-break: break-word;
        }
        .action-dropdown:focus {
            border-color: #28a745;
        }
    </style>
    <!-- Toast notification styles for pop-up messages -->
    <style id="toastStyles">
        .toast-notification {
            position: fixed;
            bottom: 32px;
            right: 32px;
            min-width: 320px;
            max-width: 360px;
            background: #23263a;
            color: #e0e0e0;
            border-radius: 10px;
            box-shadow: 0 4px 24px rgba(0,0,0,0.18), 0 1.5px 0 #38b6ff;
            padding: 18px 24px 18px 56px;
            font-size: 1rem;
            font-family: Segoe UI, Arial, sans-serif;
            z-index: 9999;
            opacity: 0;
            pointer-events: none;
            display: flex;
            align-items: center;
            gap: 16px;
            transition: opacity 0.4s, transform 0.4s;
            transform: translateY(40px);
        }
        .toast-notification.visible {
            opacity: 1;
            pointer-events: auto;
            transform: translateY(0);
        }
        .toast-icon {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .toast-close {
            margin-left: auto;
            background: none;
            border: none;
            color: #e0e0e0;
            font-size: 1.2rem;
            cursor: pointer;
            opacity: 0.7;
            transition: opacity 0.2s;
        }
        .toast-close:hover {
            opacity: 1;
        }
        .dark-mode .toast-notification {
            background: #23263a;
            color: #e0e0e0;
        }
        .toast-notification {
            background: #f8f9fa;
            color: #23263a;
        }
        .dark-mode .toast-notification {
            background: #23263a;
            color: #e0e0e0;
        }
    </style>
    <!-- CSS Stylesheet ends for the home page -->
</head>
<body>

<!-- Toast notification container for pop-up messages -->

<div id="toastContainer" style="position:fixed;z-index:9999;pointer-events:none;"></div>

<!-- Top navigation bar -->

<div class="header">
    <h1>üéì Essential Assignment Tracker

        <!-- Dark mode toggle button with sun/moon icons -->

        <button id="darkModeToggle" aria-label="Toggle dark mode" style="background:none;border:none;cursor:pointer;margin-left:12px;vertical-align:middle;outline:none;position:relative;">
            <span id="darkModeIcon" style="display:inline-block;width:32px;height:32px;vertical-align:middle;">
                <!-- Sun SVG for light mode -->
                <svg id="sunIcon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" width="32" height="32" style="display:block;">
                    <circle cx="24" cy="24" r="10" fill="#ffe066" stroke="#f9c846" stroke-width="2"/>
                    <g stroke="#f9c846" stroke-width="2">
                        <line x1="24" y1="4" x2="24" y2="12"/>
                        <line x1="24" y1="36" x2="24" y2="44"/>
                        <line x1="4" y1="24" x2="12" y2="24"/>
                        <line x1="36" y1="24" x2="44" y2="24"/>
                        <line x1="10.93" y1="10.93" x2="16.97" y2="16.97"/>
                        <line x1="31.03" y1="31.03" x2="37.07" y2="37.07"/>
                        <line x1="10.93" y1="37.07" x2="16.97" y2="31.03"/>
                        <line x1="31.03" y1="16.97" x2="37.07" y2="10.93"/>
                    </g>
                </svg>
                <!-- Moon SVG for dark mode -->
                <svg id="moonIcon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" width="32" height="32" style="display:none;">
                    <path d="M34 24c0 7-5.5 12-12 12-2.5 0-4.8-0.7-6.7-2 6.2-1.1 10.7-6.2 10.7-12.1 0-3.2-1.2-6.1-3.2-8.3C25.2 13.2 34 15.7 34 24z" fill="#b411cf" stroke="#fff" stroke-width="2"/>
                    <circle cx="30" cy="20" r="2" fill="#fff" opacity="0.7"/>
                    <circle cx="26" cy="28" r="1.2" fill="#fff" opacity="0.5"/>
                </svg>
            </span>
            <span style="position:absolute;top:40px;left:0;width:180px;background:#23263a;color:#e0e0e0;font-size:0.92rem;padding:6px 12px;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,0.12);display:none;z-index:100;" id="darkModeHint">Toggle dark mode for easier viewing</span>
        </button>
        <script>
            // Show hint on hover
            const darkModeToggleBtn = document.getElementById('darkModeToggle');
            const darkModeHint = document.getElementById('darkModeHint');
            darkModeToggleBtn.addEventListener('mouseenter',()=>{darkModeHint.style.display='block';});
            darkModeToggleBtn.addEventListener('mouseleave',()=>{darkModeHint.style.display='none';});
        </script>
    </h1>

    <!-- Navigation menu links -->

    <div class="nav">
        <a href="index.html">üè† Home</a>
        <a href="add-Assignment.html">‚ûï Add Assignment</a>
        <a href="overview.html">üìä Overview</a>
        <a href="About.html">‚ÑπÔ∏è About</a>
    </div>
</div>
<!-- Main page content -->
<div class="content">
    <!-- Counter cards showing a quick overview -->

    <div class="stats" id="stats">

        <!-- Cards will be rendered by JS -->
    </div>
    <h2>Upcoming Assignments</h2>

    <!-- Search and filter options for Assignments -->
     
    <div class="controls">
        <input type="text" id="searchInput" placeholder="Search Assignments..." />
        <select id="moduleFilter">
            <option value="">Module ‚ñº</option>
            <option value="SET08801">SET08801</option>
            <option value="SET08825">SET08825</option>
            <option value="SET09801">SET09801</option>
            <option value="SET09901">SET09901</option>
        </select>
        <select id="statusFilter">
            <option value="">Status ‚ñº</option>
            <option value="Due soon">Due Soon</option>
            <option value="Overdue">Overdue</option>
            <option value="Completed">Completed</option>
            <option value="Active">Active</option>
        </select>
    </div>
    <!-- Assignment table -->
    <table>
        <thead>
        <tr>
            <th>Assignment</th>
            <th>Module</th>
            <th>Due Date</th>
            <th>Status</th>
            <th>Actions</th>
        </tr>
        </thead>
        <tbody id="assignmentTable">
            <!-- Assignment rows rendered by JS -->
        </tbody>
    </table>
    <!-- Button to navigate to the add Assignment page and Delete Assignment button -->

    <div style="display: flex; gap: 12px; margin-top: 25px;">
        <a href="add-Assignment.html" class="add-btn">+ Add New Assignment</a>
        <button id="deleteAssignmentBtn" class="add-btn" style="background:#dc3545;" disabled>üóëÔ∏è Delete Assignment</button>
    </div>
</div>
<script>
// Toast notification logic (shows pop-up messages)
// This function displays a notification at the bottom right of the page.
// It uses SVG icons for info and check marks, and auto-hides after a few seconds.

function showNotification(message, options = {}) {

    // Get the container for toast notifications
    const toastContainer = document.getElementById('toastContainer');

    // Remove any existing toast
    toastContainer.innerHTML = '';

    // Choose the icon SVG based on the type (check/info)

    const iconSVG = options.icon === 'check' ?
        `<svg width="28" height="28" viewBox="0 0 28 28" fill="none"><circle cx="14" cy="14" r="14" fill="#38b6ff"/><path d="M8 14.5l4 4 8-8" stroke="#fff" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/></svg>` :
        `<svg width="28" height="28" viewBox="0 0 28 28" fill="none"><circle cx="14" cy="14" r="14" fill="#38b6ff"/><path d="M14 8v8" stroke="#fff" stroke-width="2.5" stroke-linecap="round"/><circle cx="14" cy="20" r="1.5" fill="#fff"/></svg>`;

    // Create the toast HTML
    const toast = document.createElement('div');
    toast.className = 'toast-notification';
    toast.innerHTML = `
        <span class="toast-icon">${iconSVG}</span>
        <span>${message}</span>
        <button class="toast-close" aria-label="Close notification">&times;</button>
    `;
    // Add close button logic
    toast.querySelector('.toast-close').onclick = () => {
        toast.classList.remove('visible');
        setTimeout(() => toast.remove(), 400);
    };
    toastContainer.appendChild(toast);

    // Show the toast with animation
    setTimeout(() => toast.classList.add('visible'), 10);

    // Auto-hide after 3.5s
    setTimeout(() => {
        toast.classList.remove('visible');
        setTimeout(() => toast.remove(), 400);
    }, options.duration || 3500);
}

// Get all assignments from localStorage, marking overdue ones

function getAssignments() {

    // Try to load assignments from localStorage
    const data = localStorage.getItem('assignments');
    let arr = data ? JSON.parse(data) : [];
    
    // Mark overdue assignments
    const today = new Date();
    today.setHours(0,0,0,0);
    arr = arr.map(a => {
        if (a.status !== 'Completed' && a.due) {
            let dueDate;
            // Parse date reliably from MM/DD/YYYY or other formats
            // This section ensures that assignment due dates are correctly interpreted
            // regardless of how the user enters them (e.g., 2026-02-25, 25/02/2026, or Mar 2, 2026).
            // It tries multiple parsing strategies so the stats and sorting are always accurate.
            dueDate = new Date(a.due);
            if (isNaN(dueDate)) {
                // Try parsing as 'MMM DD, YYYY' (e.g., Mar 2, 2026)
                dueDate = new Date(Date.parse(a.due));
            }
            dueDate.setHours(0,0,0,0);

            // If due date is before today, mark as overdue
            if (dueDate < today) a.status = 'Overdue';
        }
        return a;
    });
    return arr;
}

// Save assignments array to localStorage

function saveAssignments(assignments) {
    localStorage.setItem('assignments', JSON.stringify(assignments));
}

// Render the summary cards at the top of the page
// Shows how many assignments are due today, overdue, due this week, and completed

function renderStats(assignments) {

    // Get today's date
    const today = new Date();
    let dueToday = 0, overdue = 0, thisWeek = 0, completed = 0;
    assignments.forEach(a => {

        // Parse date reliably from MM/DD/YYYY or other formats
        // This section ensures that assignment due dates are correctly interpreted
        // regardless of how the user enters them (e.g., 2026-02-25, 25/02/2026, or Mar 2, 2026).
        // It tries multiple parsing strategies so the stats and sorting are always accurate.
        let dueDate = new Date(a.due);
        if (isNaN(dueDate)) {
            // Try parsing as 'MMM DD, YYYY' (e.g., Mar 2, 2026)
            dueDate = new Date(Date.parse(a.due));
        }
        if (a.status === "Completed") completed++;
        else if (a.status === "Overdue") overdue++;
        if (dueDate.toDateString() === today.toDateString()) dueToday++;
        // Check if due this week (today through coming Sunday)
        const weekStart = new Date(today);
        weekStart.setHours(0,0,0,0);
        const weekEnd = new Date(today);
        weekEnd.setDate(today.getDate() + (7 - today.getDay() - 1)); // End of current week (Sunday)
        weekEnd.setHours(23,59,59,999);
        if (dueDate >= weekStart && dueDate <= weekEnd) thisWeek++;
    });
    // function: returns SVG for stat circle

    // If value is 0, the circle is invisible (hidden)

    // If value is nonzero, the circle is visible and animated

    function getStatCircle(val, color) {

        // If stat value is zero, hide the circle
        if (val === 0) {
            return `<svg width="70" height="70" style="visibility:hidden"><circle cx="35" cy="35" r="32" stroke="${color}" stroke-width="6" fill="none" /></svg>`;
        } else {
            // If stat value is nonzero, show and animate the circle
            
            return `<svg width="70" height="70"><circle cx="35" cy="35" r="32" stroke="${color}" stroke-width="6" fill="none" class="stat-anim" /></svg>`;
        }
    }

    // Render stat cards with animated/invisible circles
    document.getElementById('stats').innerHTML = `
        <div class="card">
            <h3>Due Today</h3>
            <div class="stat-circle">
                ${getStatCircle(dueToday, '#fd7e14')}
                <span class="number due-soon">${dueToday}</span>
            </div>
        </div>
        <div class="card">
            <h3>Overdue</h3>
            <div class="stat-circle">
                ${getStatCircle(overdue, '#dc3545')}
                <span class="number overdue">${overdue}</span>
            </div>
        </div>
        <div class="card">
            <h3>This Week</h3>
            <div class="stat-circle">
                ${getStatCircle(thisWeek, '#0385b8')}
                <span class="number active">${thisWeek}</span>
            </div>
        </div>
        <div class="card">
            <h3>Completed</h3>
            <div class="stat-circle">
                ${getStatCircle(completed, '#28a745')}
                <span class="number completed">${completed}</span>
            </div>
        </div>
    `;
}

// Render the assignments table
// This function displays all assignments in the table, with status badges and action buttons
function renderAssignments(assignments) {
    // Get the table body element
    const table = document.getElementById('assignmentTable');
    table.innerHTML = '';
    // Helper to map status to CSS class
    function getStatusClass(status) {
        switch (status) {
            case 'Completed': return 'status-Completed';
            case 'Overdue': return 'status-overdue';
            case 'Due soon': return 'status-due';
            case 'Active': return 'status-active';
            case 'Done': return 'status-done';
            case 'Normal': return 'status-normal';
            default: return 'status-normal';
        }
    }
    // Loop through assignments and add rows
    assignments.forEach((a, idx) => {
        let dateValue = '';
        const parsedDate = new Date(a.due);
        if (!isNaN(parsedDate)) {
            dateValue = parsedDate.toISOString().split('T')[0];
        }
        const statusClass = getStatusClass(a.status);
        table.innerHTML += `
            <tr class="assignment-row" data-idx="${idx}" tabindex="0" style="cursor:pointer;">
                <td>
                  ${a.name}
                  ${a.notes ? `<div class="notes-inline">${a.notes}</div>` : ''}
                  <button class="action-btn edit-btn" onclick="editAssignment(${idx});event.stopPropagation();" style="margin-top:4px;">Edit</button>
                </td>
                <td>${a.module}</td>
                <td>
                    <span>${a.due}</span><br>
                    <input type="date" value="${dateValue}" onchange="changeDueDate(${idx}, this.value);event.stopPropagation();" style="margin-top:4px;" />
                </td>
                <td><span class="status ${statusClass}">${a.status}</span></td>
                <td>
                    <select class="action-dropdown" onchange="updateStatus(${idx}, this.value);event.stopPropagation();">
                        <option value="Active" ${a.status === 'Active' ? 'selected' : ''}>Active</option>
                        <option value="Due soon" ${a.status === 'Due soon' ? 'selected' : ''}>Due Soon</option>
                        <option value="Completed" ${a.status === 'Completed' ? 'selected' : ''}>Completed</option>
                        <option value="Overdue" ${a.status === 'Overdue' ? 'selected' : ''}>Overdue</option>
                    </select>
                </td>
            </tr>
        `;
    });
}

// Edit assignment: opens the add-Assignment page with the assignment's index for editing

function editAssignment(idx) {
    window.location.href = `add-Assignment.html?edit=${idx}`;
}

// Change the due date for an assignment

function changeDueDate(idx, newDate) {

    // Get all assignments

    const assignments = getAssignments();

    // Format date for display

    const dateObj = new Date(newDate);
    const displayDate = dateObj.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
    assignments[idx].due = displayDate;
    saveAssignments(assignments);
    renderStats(assignments);
    renderAssignments(assignments);
    showNotification('Assignment due date updated!', { icon: 'check' });
}

// Update the status for an assignment

function updateStatus(idx, status) {

    // Get all assignments

    const assignments = getAssignments();
    assignments[idx].status = status;
    saveAssignments(assignments);
    renderStats(assignments);
    renderAssignments(assignments);
    showNotification('Assignment status updated!', { icon: 'check' });
}

// Filter assignments based on search, module, and status

function filterAssignments() {

    // Get filter values

    const search = document.getElementById('searchInput').value.toLowerCase();
    const module = document.getElementById('moduleFilter').value;
    const status = document.getElementById('statusFilter').value;
    let assignments = getAssignments();
    
    // Filter assignments based on user input

    assignments = assignments.filter(a => {
        const matchesSearch = a.name.toLowerCase().includes(search);
        const matchesModule = !module || a.module === module;
        const matchesStatus = !status || a.status === status;
        return matchesSearch && matchesModule && matchesStatus;
    });
    renderAssignments(assignments);
}

document.getElementById('searchInput').addEventListener('input', filterAssignments);
document.getElementById('moduleFilter').addEventListener('change', filterAssignments);
document.getElementById('statusFilter').addEventListener('change', filterAssignments);

// Initial render: load assignments and display stats and table
const assignments = getAssignments();
renderStats(assignments);
renderAssignments(assignments);

// Delete assignment logic

// Handles row selection and deleting an assignment from the list

let selectedAssignmentIdx = null;
const assignmentTable = document.getElementById('assignmentTable');
const deleteBtn = document.getElementById('deleteAssignmentBtn');

function clearRowSelection() {
    document.querySelectorAll('.assignment-row.selected').forEach(row => row.classList.remove('selected'));
    selectedAssignmentIdx = null;
    if (deleteBtn) deleteBtn.disabled = true;
}

assignmentTable.addEventListener('click', function(e) {
    let row = e.target.closest('.assignment-row');
    if (!row) return;
    clearRowSelection();
    row.classList.add('selected');
    selectedAssignmentIdx = parseInt(row.getAttribute('data-idx'));
    if (deleteBtn) deleteBtn.disabled = false;
});

if (deleteBtn) {
    deleteBtn.addEventListener('click', function() {
        if (selectedAssignmentIdx === null) return;
        let assignments = getAssignments();
        if (assignments[selectedAssignmentIdx]) {
            if (confirm('Are you sure you want to delete this assignment?')) {
                assignments.splice(selectedAssignmentIdx, 1);
                saveAssignments(assignments);
                renderStats(assignments);
                renderAssignments(assignments);
                clearRowSelection();
                showNotification('Assignment deleted!', { icon: 'check' });
            }
        }
    });
}
</script>
<script>
// Dark mode toggle logic with sun/moon icons
// This section enables the user to switch between light and dark themes.
// The sun icon is shown in light mode, and the moon icon in dark mode.
// Smooth transition for theme toggle
const darkModeToggle = document.getElementById('darkModeToggle');
const sunIcon = document.getElementById('sunIcon');
const moonIcon = document.getElementById('moonIcon');
function setDarkMode(on) {
    
    // Add smooth transition for background and color
    document.body.style.transition = 'background 3s, color 1s';
    document.documentElement.classList.toggle('dark-mode', on);
    if (on) {
        sunIcon.style.display = 'none';
        moonIcon.style.display = 'block';
    } else {
        sunIcon.style.display = 'block';
        moonIcon.style.display = 'none';
    }
    localStorage.setItem('darkMode', on ? '1' : '0');
}
const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
const saved = localStorage.getItem('darkMode');
const dark = saved === null ? prefersDark : saved === '1';
setDarkMode(dark);
darkModeToggle.addEventListener('click', () => {
    setDarkMode(!document.documentElement.classList.contains('dark-mode'));
});
</script>

</body>
</html>