<!--
    CSS for the Add Assignment page is in: css/add-Assignment.css
    
    (See the <link rel="stylesheet" href="css/add-Assignment.css"> in the <head> section.)
-->

<!DOCTYPE html>
<html lang="en">
<head>
        <!-- Toast notification styles -->
         
        <style id="toastStyles">
            .toast-notification {
                position: fixed;
                bottom: 32px;
                right: 32px;
                min-width: 320px;
                max-width: 360px;
                background: #23263a;
                color: #e0e0e0;
                border-radius: 10px;
                box-shadow: 0 4px 24px rgba(0,0,0,0.18), 0 1.5px 0 #38b6ff;
                padding: 18px 24px 18px 56px;
                font-size: 1rem;
                font-family: Segoe UI, Arial, sans-serif;
                z-index: 9999;
                opacity: 0;
                pointer-events: none;
                display: flex;
                align-items: center;
                gap: 16px;
                transition: opacity 0.4s, transform 0.4s;
                transform: translateY(40px);
            }
            .toast-notification.visible {
                opacity: 1;
                pointer-events: auto;
                transform: translateY(0);
            }
            .toast-icon {
                position: absolute;
                left: 20px;
                top: 50%;
                transform: translateY(-50%);
                width: 28px;
                height: 28px;
                display: flex;
                align-items: center;
                justify-content: center;
            }
            .toast-close {
                margin-left: auto;
                background: none;
                border: none;
                color: #e0e0e0;
                font-size: 1.2rem;
                cursor: pointer;
                opacity: 0.7;
                transition: opacity 0.2s;
            }
            .toast-close:hover {
                opacity: 1;
            }
            .dark-mode .toast-notification {
                background: #23263a;
                color: #e0e0e0;
            }
            .toast-notification {
                background: #f8f9fa;
                color: #23263a;
            }
            .dark-mode .toast-notification {
                background: #23263a;
                color: #e0e0e0;
            }
        </style>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Essential Assignment Tracker - Add New Assignment</title>

    <link rel="stylesheet" href="css/add-Assignment.css">
</head>
<body>

<!--
    This is the container where toast notifications (pop-up messages) will appear on the screen.

    When the user saves or updates an assignment, a small message box will show up here to confirm the action.
    
    Only one toast notification is shown at a time, and it disappears automatically after a few seconds or when closed.
-->

<div id="toastContainer" style="position:fixed;z-index:9999;pointer-events:none;"></div>

<!-- Header section with navigation -->
<div class="header">
    <a href="index.html" class="back-btn">‚Üê Back</a>
    <div style="display: flex; align-items: center; width: 100%; justify-content: space-between;">
        <h1 style="margin: 0; font-size: 1.5rem; color: #f2e7f4; display: flex; align-items: center;">üéì Essential Assignment Tracker
            <button id="darkModeToggle" aria-label="Toggle dark mode" style="background:none;border:none;cursor:pointer;margin-left:12px;vertical-align:middle;outline:none;position:relative;">
                <span id="darkModeIcon" style="display:inline-block;width:32px;height:32px;vertical-align:middle;">

                    <!-- Sun SVG for light mode -->
                    <svg id="sunIcon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" width="32" height="32" style="display:block;">
                        <circle cx="24" cy="24" r="10" fill="#ffe066" stroke="#f9c846" stroke-width="2"/>
                        <g stroke="#f9c846" stroke-width="2">
                            <line x1="24" y1="4" x2="24" y2="12"/>
                            <line x1="24" y1="36" x2="24" y2="44"/>
                            <line x1="4" y1="24" x2="12" y2="24"/>
                            <line x1="36" y1="24" x2="44" y2="24"/>
                            <line x1="10.93" y1="10.93" x2="16.97" y2="16.97"/>
                            <line x1="31.03" y1="31.03" x2="37.07" y2="37.07"/>
                            <line x1="10.93" y1="37.07" x2="16.97" y2="31.03"/>
                            <line x1="31.03" y1="16.97" x2="37.07" y2="10.93"/>
                        </g>
                    </svg>
                    <!-- Moon SVG for dark mode -->
                    <svg id="moonIcon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" width="32" height="32" style="display:none;">
                        <path d="M34 24c0 7-5.5 12-12 12-2.5 0-4.8-0.7-6.7-2 6.2-1.1 10.7-6.2 10.7-12.1 0-3.2-1.2-6.1-3.2-8.3C25.2 13.2 34 15.7 34 24z" fill="#b411cf" stroke="#fff" stroke-width="2"/>
                        <circle cx="30" cy="20" r="2" fill="#fff" opacity="0.7"/>
                        <circle cx="26" cy="28" r="1.2" fill="#fff" opacity="0.5"/>
                    </svg>
                </span>
                <span style="position:absolute;top:40px;left:0;width:180px;background:#23263a;color:#e0e0e0;font-size:0.92rem;padding:6px 12px;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,0.12);display:none;z-index:100;" id="darkModeHint">Toggle dark mode for easier viewing</span>
            </button>
        </h1>
        <div class="nav">
            <a href="index.html">üè† Home</a>
            <a href="add-Assignment.html">‚ûï Add Assignment</a>
            <a href="overview.html">üìä Overview</a>
            <a href="About.html">‚ÑπÔ∏è About</a>
        </div>
    </div>
    <script>
        // Show hint on hover

        const darkModeToggleBtn = document.getElementById('darkModeToggle');
        const darkModeHint = document.getElementById('darkModeHint');
        darkModeToggleBtn.addEventListener('mouseenter',()=>{darkModeHint.style.display='block';});
        darkModeToggleBtn.addEventListener('mouseleave',()=>{darkModeHint.style.display='none';});
    </script>
</div>

<!-- Main content area -->

<div class="content">
    <h2>Add New Assignment</h2>

    <!-- Form for adding a new Assignment -->
     
    <form id="assignmentForm">
        <table class="form-table">
            <tr>
                <td class="label">Assignment Name:</td>
                <td class="input">
                    <input type="text" name="Assignment_name" placeholder="e.g. Assignment 1" required />
                </td>
            </tr>
            <tr>
                <td class="label">Module / Course:</td>
                <td class="input">
                    <input type="text" name="module" placeholder="e.g. COM101 / Mathematics 202" required />
                </td>
            </tr>
            <tr>
                <td class="label">Due Date:</td>
                <td class="input">
                    <input type="date" name="due_date" required />
                </td>
            </tr>
            <tr>
                <td class="label">Priority:</td>
                <td class="input">
                    <select name="priority">
                        <option value="low">Low</option>
                        <option value="medium" selected>Medium</option>
                        <option value="high">High</option>
                    </select>
                </td>
            </tr>
            <tr>
                <td class="label">Status:</td>
                <td class="input">
                    <select name="status" id="statusSelect">
                        <option value="Active">Active</option>
                        <option value="Due soon">Due Soon</option>
                        <option value="Overdue">Overdue</option>
                        <option value="Completed">Completed</option>
                    </select>
                    <div id="statusPreview" class="status-preview status-Active">Active</div>
                </td>
            </tr>
            <tr>
                <td class="label">Notes / Description:</td>
                <td class="input">
                    <textarea name="notes" placeholder="Any extra details, requirements, links..."></textarea>
                </td>
            </tr>
        </table>

        <button type="submit" class="save-btn">Save Assignment</button>
    </form>

    <script>
        
// Toast notification logic (Windows style)

// This function shows a pop-up message to the user when an assignment is saved or updated.

// It uses SVG icons for info and check marks, and auto-hides after a few seconds.

function showNotification(message, options = {}) {
    const toastContainer = document.getElementById('toastContainer'); // Container for toast messages

    // Before showing a new toast notification, remove any previous notification from the screen.

    // This ensures that only one toast message is visible at a time, so the user doesn't get confused by multiple pop-ups.

    toastContainer.innerHTML = '';

    // Choose which icon to show in the toast notification.

    // If the notification is for success (like saving), show a check mark icon.

    // Otherwise, show an info icon. These icons are SVG images that appear in the pop-up message.

    const iconSVG = options.icon === 'check' ?
        `<svg width="28" height="28" viewBox="0 0 28 28" fill="none"><circle cx="14" cy="14" r="14" fill="#38b6ff"/><path d="M8 14.5l4 4 8-8" stroke="#fff" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/></svg>` :
        `<svg width="28" height="28" viewBox="0 0 28 28" fill="none"><circle cx="14" cy="14" r="14" fill="#38b6ff"/><path d="M14 8v8" stroke="#fff" stroke-width="2.5" stroke-linecap="round"/><circle cx="14" cy="20" r="1.5" fill="#fff"/></svg>`;

    // Create the HTML for the toast notification.

    // This builds the pop-up message box that appears in the corner of the screen.

    const toast = document.createElement('div');
    toast.className = 'toast-notification';
    toast.innerHTML = `
        <span class="toast-icon">${iconSVG}</span>
        <span>${message}</span>
        <button class="toast-close" aria-label="Close notification">&times;</button>
    `;
    // This code makes the 'X' close button on the toast notification work.
    
    // When the user clicks the close button, the notification fades out and is removed from the page.

    toast.querySelector('.toast-close').onclick = () => {
        toast.classList.remove('visible');
        setTimeout(() => toast.remove(), 400);
    };
    toastContainer.appendChild(toast);

    // Show toast system notification with animation
    
    setTimeout(() => toast.classList.add('visible'), 10);

    // Auto-hide after 3.5s
    
    setTimeout(() => {
        toast.classList.remove('visible');
        setTimeout(() => toast.remove(), 400);
    }, options.duration || 3500);
}
// Update status preview when dropdown changes 

// This updates the colored status badge when the user selects a new status in the form.

document.getElementById('statusSelect').addEventListener('change', function(e) {
    const val = e.target.value;
    const preview = document.getElementById('statusPreview');
    preview.textContent = val;

    // Map status to class for color coding: Active = blue, Due Soon = orange, Overdue = red, Completed = green. This gives the user a visual cue about the status of the assignment based on color.

    let statusClass = 'status-preview ';
    if (val === 'Active') statusClass += 'status-Active';
    else if (val === 'Due soon') statusClass += 'status-due';
    else if (val === 'Overdue') statusClass += 'status-overdue';
    else if (val === 'Completed') statusClass += 'status-done';
    else statusClass += 'status-Active';
    preview.className = statusClass;
});

// This section loads an assignment for editing if the user clicked 'edit' on the main page.

// It fills the form with the assignment's details so the user can update them.

function getQueryParam(param) {

    const urlParams = new URLSearchParams(window.location.search);
    return urlParams.has(param) ? urlParams.get(param) : null;
}

const editIdx = getQueryParam('edit');
if (editIdx !== null) {

    // Load assignment for editing based on the index passed in the URL query parameter. This allows the form to be used for both adding new assignments and editing existing ones, depending on whether an 'edit' parameter is present in the URL.

    let assignments = [];
    try {
        assignments = JSON.parse(localStorage.getItem('assignments')) || [];
    } catch {}
    const assignment = assignments[parseInt(editIdx)];
    if (assignment) {
        document.querySelector('input[name="Assignment_name"]').value = assignment.name;
        document.querySelector('input[name="module"]').value = assignment.module;

        // Parse date for input field (expects format like "Mar 15, 2025") and convert to "YYYY-MM-DD" for the date input. This allows the form to show the correct due date when editing an assignment.

        let dateObj = new Date(assignment.due);
        if (!isNaN(dateObj)) {
            document.querySelector('input[name="due_date"]').value = dateObj.toISOString().split('T')[0];
        }
        document.querySelector('select[name="status"]').value = assignment.status;
        document.querySelector('textarea[name="notes"]').value = assignment.notes || '';

        // Change button text to "Update Assignment" when editing an existing assignment, to make it clear to the user that they are updating rather than creating a new assignment.

        document.querySelector('.save-btn').textContent = 'Update Assignment';
    }
}

document.getElementById('assignmentForm').addEventListener('submit', function(e) {

    e.preventDefault(); // Stop the page from reloading when the form is submitted, so we can handle the data with JavaScript instead.

    const form = e.target;

    // Get values from the form

    const name = form.Assignment_name.value.trim();
    const module = form.module.value.trim();
    const due = new Date(form.due_date.value);
    const displayDue = due.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
    const status = form.status.value;
    const notes = form.notes.value.trim();
    let assignments = [];
    try {
        assignments = JSON.parse(localStorage.getItem('assignments')) || [];
    } catch {}
    if (editIdx !== null && assignments[parseInt(editIdx)]) {

        // Update existing assignment

        assignments[parseInt(editIdx)] = { name, module, due: displayDue, status, notes };
    } else {
        // Add new assignment
        
        assignments.push({ name, module, due: displayDue, status, notes });
    }
    // Save assignments to localStorage as a JSON string. This allows the data to persist in the browser so that when the user returns to the site, their assignments will still be there.

    localStorage.setItem('assignments', JSON.stringify(assignments));

    // Set a flag in sessionStorage to show a notification on the homepage after redirecting back. This lets the homepage know whether to show a "saved" or "updated" message to the user, providing feedback that their action was successful.

    if (editIdx !== null) {
        sessionStorage.setItem('assignmentStatus', 'updated');
    } else {
        sessionStorage.setItem('assignmentStatus', 'saved');
    }

    // Redirect to home page after saving or updating the assignment, and show a notification there confirming the action. The notification will say "Assignment saved!" or "Assignment updated!" depending on whether it was a new assignment or an edit.

    setTimeout(function() {
        window.location.href = 'index.html';
    }, 600);
});
    </script>
</div>

</body>
<script>

// Dark mode toggle logic with sun/moon icons

// This section enables the user to switch between light and dark themes.

// The sun icon is shown in light mode, and the moon icon in dark mode.

const darkModeToggle = document.getElementById('darkModeToggle'); // Button for toggling theme

const sunIcon = document.getElementById('sunIcon'); // Sun SVG for light mode

const moonIcon = document.getElementById('moonIcon'); // Moon SVG for dark mode

// Function to set dark mode on or off and save the user's preference in localStorage

function setDarkMode(on) {

        // Add smooth transition for background and color when toggling dark mode, so it doesn't switch abruptly. The transition makes the theme change feel more polished and less jarring to the user.
        
        document.body.style.transition = 'background 3s, color 1s';

    // Toggle the 'dark-mode' class on the root element to switch themes. The CSS will define different styles for light and dark modes based on this class.
    
    document.documentElement.classList.toggle('dark-mode', on);

    // Show moon icon in dark mode, sun icon in light mode by changing their display styles

    if (on) {
        sunIcon.style.display = 'none';
        moonIcon.style.display = 'block';
    } else {
        sunIcon.style.display = 'block';
        moonIcon.style.display = 'none';
    }
    // Save the user's preference in localStorage so that when they return to the site, it will load in their chosen theme instead of defaulting to the system preference. This makes the experience more personalized and consistent across visits.

    localStorage.setItem('darkMode', on ? '1' : '0');
}

// Detect system preference or saved setting for dark mode and apply it on page load. This ensures that the site respects the user's system settings by default, but also allows them to override it with their own preference that will be remembered for future visits.

const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
const saved = localStorage.getItem('darkMode');
const dark = saved === null ? prefersDark : saved === '1';
setDarkMode(dark);

// When the toggle button is clicked, switch the theme and update the icons accordingly. This allows users to manually choose their preferred theme regardless of their system settings.

// This lets the user manually change between light and dark mode by clicking the button, and the icons will update to reflect the current mode. The user's choice is remembered for future visits.

// The icon updates automatically when the user toggles the theme, providing visual feedback about which mode is active. The preference is saved so that when the user returns to the site, it will load in their chosen theme.

darkModeToggle.addEventListener('click', () => {
    setDarkMode(!document.documentElement.classList.contains('dark-mode'));
});
</script>
</html>